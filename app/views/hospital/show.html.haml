%h1 #{@hospital.name}
%h3 #{@hospital.sub_type}

.row-fluid
	.span8
		%p hospital description here
		%p phone number here
		%a website here
	.span4
		.well
			%p map here
			%p #{@hospital.addr_street} <br> #{@hospital.addr_city}, IL #{@hospital.addr_zip}
			%a{:href => "https://maps.google.com/maps?f=d&hl=en&geocode=&daddr=#{@hospital.addr_street}+#{@hospital.addr_city},+IL+#{@hospital.addr_zip}"} <button class="btn">Get Directions</button>
.row-fluid
	.span12
		%h3 Hospital Admissions
		- admissions_by_race = fetch_provider_data(@hospital.src_id, "Admissions by Race")
		- admissions_by_ethnicity = fetch_provider_data(@hospital.src_id, "Admissions by Ethnicity")
		- total_admissions = admissions_by_race[:values].sum
		- admissions_by_type = fetch_provider_data(@hospital.src_id, "Admissions by Type")
		- medsurg_admissions_by_age = fetch_provider_data(@hospital.src_id, "Medical-Surgical Admissions By Age")
		- total_medsurg_admissions = medsurg_admissions_by_age[:values].sum
		%p Admissions data in 2012. Hospital admissions are broken down by those in medical-surgical units and those outside medical-surgical units.
.row-fluid
	.span4
		%h4 Total Admissions
		%p.big-text #{total_admissions.to_i}
	.span8
		%h4 % Medical-Surgical Admissions
		%p.big-text #{(total_medsurg_admissions/total_admissions*100).to_i}% <small>(#{total_medsurg_admissions.to_i})</small>
.row-fluid
	.span8
		%h4 All Admissions - by Race
		- chart_id = "chart_admissions_race"
		.chart{:id => chart_id}
		- content_for :javascripts do
			:javascript
				$(function () {

					var seriesData = [{
						data: #{admissions_by_race[:values]},
						name: "Admissions"
					}];
					ChartHelper.create("#{chart_id}", "column", seriesData, "", "", "", "count", #{admissions_by_race[:stats]});
				});
	.span4
		%h4 All Admissions - by Ethnicity
		- chart_id = "chart_admissions_ethnicity"
		.chart{:id => chart_id}
		- content_for :javascripts do
			:javascript
				$(function () {

					var seriesData = [{
						data: #{admissions_by_ethnicity[:values]},
						name: "Admissions"
					}];
					ChartHelper.create("#{chart_id}", "column", seriesData, "", "", "", "count", #{admissions_by_ethnicity[:stats]});
				});
.row-fluid
	.span12
		%h4#admissions-by-type Non-Medical-Surgical Admissions - by Type
		%p
		- chart_id = "chart_admissions_type"
		.chart{:id => chart_id}
		- content_for :javascripts do
			:javascript
				$(function () {

					var seriesData = [{
						data: #{admissions_by_type[:values]},
						name: "Admissions"
					}];
					ChartHelper.create("#{chart_id}", "column", seriesData, "", "", "", "count", #{admissions_by_type[:stats]});
				});
		%h4#medsurg-admissions-by-age Medical-Surgical Admissions - by Age
		%p
		- chart_id = "chart_admissions_age"
		.chart{:id => chart_id}
		- content_for :javascripts do
			:javascript
				$(function () {

					var seriesData = [{
						data: #{medsurg_admissions_by_age[:values]},
						name: "Admissions"
					}];
					ChartHelper.create("#{chart_id}", "column", seriesData, "", "", "", "count", #{medsurg_admissions_by_age[:stats]});
				});

.row-fluid
	.span12
		- revenue_inpatient = fetch_provider_data(@hospital.src_id, "Inpatient Revenue by Payment Type")
		- inpatient_total = revenue_inpatient[:values].sum
		- revenue_outpatient = fetch_provider_data(@hospital.src_id, "Outpatient Revenue by Payment Type")
		- outpatient_total = revenue_outpatient[:values].sum
		%h3 Hospital Revenue
		%p Inpatient and outpatient revenue data over the reporting period from #{revenue_inpatient[:start_date].strftime("%m/%d/%y")} to #{revenue_inpatient[:end_date].strftime("%m/%d/%y")}.
.row-fluid
	.span4
		%h4#revenue-total Total Revenue
		%p Description
		.chart{:id => "rev_total"}
		- content_for :javascripts do
			:javascript
				$(function () {
					var seriesData = [
						{data: [#{outpatient_total}], name: "Outpatient Revenue"},
						{data: [#{inpatient_total}], name: "Inpatient Revenue"}
					]
					ChartHelper.create("rev_total", "column", seriesData, "", "", "", "money", ["Total Revenue"], true);
				});
	.span8
		%h4#revenue-combined Revenue by Source
		%p Description
		.chart{:id => "rev_combined"}
		- content_for :javascripts do
			:javascript
				$(function () {

					var seriesData = [
						{data: #{revenue_outpatient[:values]},
						name: "Outpatient Revenue"},
						{data: #{revenue_inpatient[:values]},
						name: "Inpatient Revenue"}];
					ChartHelper.create("rev_combined", "column", seriesData, "", "", "", "money", #{revenue_inpatient[:stats]}, true);
				});
